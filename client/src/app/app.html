<main class="layout">
  <section class="card">
    <header class="card__header">
      <h1>Patient Intake</h1>
      <p class="card__subtitle">
        Provide the basic patient details and chief complaint to generate a clinical intake summary.
      </p>
    </header>

    <app-patient-intake-form
      [intakeForm]="intakeForm"
      [genders]="genders()"
      [isSubmitting]="isSubmitting()"
      (submitForm)="submit()"
      (resetForm)="resetForm()"
    />

    @if (submissionResult(); as result) {
      <app-antecedents-section
        [model]="result.model"
        [answer]="result.answer"
        [options]="antecedentOptions()"
        [selected]="selectedAntecedentsList()"
        [customList]="customAntecedentsList()"
        [customText]="customAntecedentText()"
        [isSubmitting]="isSubmitting()"
        [canRequestMore]="canRequestMoreOptions()"
        (requestMore)="requestMoreAntecedents()"
        (toggleOption)="onAntecedentToggle($event.option, $event.checked)"
        (addCustom)="addCustomAntecedent()"
        (customTextChange)="updateCustomAntecedentText($event)"
        (removeCustom)="removeCustomAntecedent($event)"
      />
    }

    @if (submissionError(); as error) {
      <section class="result result--error">
        <h2>Submission Failed</h2>
        <p>{{ error }}</p>
      </section>
    }
  </section>
</main>
